# Configuration with Bluetooth enabled

CONFIG_PICOLIBC_IO_FLOAT=y
# Basic peripherals
CONFIG_GPIO=y

# Core features
CONFIG_CLOCK_CONTROL=y

# Bluetooth configuration - with increased buffer sizes
CONFIG_BT=y
CONFIG_BT_PERIPHERAL=y
CONFIG_BT_DEVICE_NAME="ManikinTest"
CONFIG_BT_RX_STACK_SIZE=4096
CONFIG_STM32H7_BOOT_M4_AT_INIT=n

CONFIG_SHELL=y
CONFIG_HEAP_MEM_POOL_SIZE=1024

# Increase BLE buffer sizes to handle larger payloads
# Use options compatible with this Zephyr version
CONFIG_BT_BUF_ACL_RX_SIZE=100
CONFIG_BT_BUF_ACL_TX_SIZE=100
CONFIG_BT_CONN_TX_MAX=10

# Ensure we can handle multiple parallel operations
CONFIG_BT_ATT_TX_COUNT=10
CONFIG_BT_ATT_PREPARE_COUNT=5

# Logging configuration
CONFIG_LOG=y
CONFIG_LOG_MAX_LEVEL=4
CONFIG_LOG_MODE_IMMEDIATE=y 
CONFIG_USE_SEGGER_RTT=y
CONFIG_LOG_BACKEND_RTT=y

# Enable CAN and ISOTP
CONFIG_CAN=y
CONFIG_CAN_DEFAULT_BITRATE=500000
CONFIG_ISOTP=y
CONFIG_ISOTP_RX_BUF_COUNT=10
CONFIG_ISOTP_TX_CONTEXT_BUF_COUNT=10
CONFIG_ISOTP_RX_SF_FF_BUF_COUNT=10
# Stack sizes
CONFIG_MAIN_STACK_SIZE=2048
CONFIG_ISR_STACK_SIZE=2048

# Console configuration
CONFIG_RTT_CONSOLE=y
CONFIG_LOG_BACKEND_UART=n
CONFIG_UART_CONSOLE=n

CONFIG_USB_DEVICE_STACK=y
CONFIG_USB_DEVICE_PRODUCT="Zephyr CDC ACM sample"
CONFIG_USB_DEVICE_PID=0x0001
CONFIG_USB_DRIVER_LOG_LEVEL_ERR=y
CONFIG_USB_DEVICE_LOG_LEVEL_ERR=y
CONFIG_SERIAL=y
CONFIG_UART_INTERRUPT_DRIVEN=y
CONFIG_UART_LINE_CTRL=y
CONFIG_USB_DEVICE_INITIALIZE_AT_BOOT=y

#enable disk
CONFIG_DISK_ACCESS=y
CONFIG_DISK_DRIVER_SDMMC=y
CONFIG_SDMMC_STM32=y
CONFIG_FILE_SYSTEM=y                     # Enables file system core
CONFIG_FAT_FILESYSTEM_ELM=y              # Enables ELM FAT driver (default for FATFS)